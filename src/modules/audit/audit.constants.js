/**
 * Audit Constants
 *
 * Defines action types, entity types, and other constants used throughout the audit module.
 * Provides centralized management of audit-related constants for consistency and maintainability.
 *
 * Key Features:
 * - Action type constants for all audit events
 * - Entity type constants for different system entities
 * - Audit log configuration constants
 * - Centralized constant management
 *
 * @author FundFlow Team
 * @version 1.0.0
 */

// Action Types - Authentication
export const AUTH_ACTIONS = {
  USER_LOGIN: "USER_LOGIN",
  USER_LOGOUT: "USER_LOGOUT",
  USER_REGISTERED: "USER_REGISTERED",
  PASSWORD_CHANGED: "PASSWORD_CHANGED",
  PASSWORD_RESET_REQUESTED: "PASSWORD_RESET_REQUESTED",
  PASSWORD_RESET_COMPLETED: "PASSWORD_RESET_COMPLETED",
  EMAIL_VERIFIED: "EMAIL_VERIFIED",
  ACCOUNT_SUSPENDED: "ACCOUNT_SUSPENDED",
  ACCOUNT_ACTIVATED: "ACCOUNT_ACTIVATED",
};

// Action Types - Campaign Management
export const CAMPAIGN_ACTIONS = {
  CAMPAIGN_CREATED: "CAMPAIGN_CREATED",
  CAMPAIGN_UPDATED: "CAMPAIGN_UPDATED",
  CAMPAIGN_DELETED: "CAMPAIGN_DELETED",
  CAMPAIGN_SUBMITTED: "CAMPAIGN_SUBMITTED",
  CAMPAIGN_APPROVED: "CAMPAIGN_APPROVED",
  CAMPAIGN_REJECTED: "CAMPAIGN_REJECTED",
  CAMPAIGN_CANCELLED: "CAMPAIGN_CANCELLED",
  CAMPAIGN_PUBLISHED: "CAMPAIGN_PUBLISHED",
  CAMPAIGN_PAUSED: "CAMPAIGN_PAUSED",
  CAMPAIGN_RESUMED: "CAMPAIGN_RESUMED",
};

// Action Types - User Management
export const USER_ACTIONS = {
  USER_PROFILE_UPDATED: "USER_PROFILE_UPDATED",
  USER_ROLE_CHANGED: "USER_ROLE_CHANGED",
  USER_PERMISSIONS_UPDATED: "USER_PERMISSIONS_UPDATED",
  ORGANIZATION_CREATED: "ORGANIZATION_CREATED",
  ORGANIZATION_UPDATED: "ORGANIZATION_UPDATED",
};

// Action Types - Donations
export const DONATION_ACTIONS = {
  DONATION_MADE: "DONATION_MADE",
  DONATION_REFUNDED: "DONATION_REFUNDED",
  DONATION_CANCELLED: "DONATION_CANCELLED",
};

// Action Types - System Operations
export const SYSTEM_ACTIONS = {
  SYSTEM_BACKUP: "SYSTEM_BACKUP",
  SYSTEM_MAINTENANCE: "SYSTEM_MAINTENANCE",
  CONFIGURATION_CHANGED: "CONFIGURATION_CHANGED",
  SECURITY_ALERT: "SECURITY_ALERT",
};

// Action Types - Outreach
export const OUTREACH_ACTIONS = {
  CONTACT_CREATED: "CONTACT_CREATED",
  CONTACT_UPDATED: "CONTACT_UPDATED",
  CONTACT_DELETED: "CONTACT_DELETED",
  SEGMENT_CREATED: "SEGMENT_CREATED",
  SEGMENT_UPDATED: "SEGMENT_UPDATED",
  SEGMENT_DELETED: "SEGMENT_DELETED",
};

// Action Types - Notifications
export const NOTIFICATION_ACTIONS = {
  NOTIFICATION_SENT: "NOTIFICATION_SENT",
  NOTIFICATION_READ: "NOTIFICATION_READ",
  EMAIL_SENT: "EMAIL_SENT",
  SMS_SENT: "SMS_SENT",
};

// Entity Types
export const ENTITY_TYPES = {
  USER: "User",
  CAMPAIGN: "Campaign",
  DONATION: "Donation",
  TRANSACTION: "Transaction",
  WITHDRAWAL_REQUEST: "WithdrawalRequest",
  ORGANIZATION: "Organization",
  CONTACT: "Contact",
  SEGMENT: "Segment",
  NOTIFICATION: "Notification",
  CATEGORY: "Category",
  MEDIA: "Media",
};

// Audit Log Configuration
export const AUDIT_CONFIG = {
  DEFAULT_PAGE_SIZE: 50,
  MAX_PAGE_SIZE: 100,
  RETENTION_DAYS: 365, // Default retention period
  MAX_DETAILS_SIZE: 10000, // Maximum size for details JSONB in characters
  SENSITIVE_FIELDS: [
    "password",
    "passwordHash",
    "token",
    "refreshToken",
    "resetToken",
    "verificationToken",
  ],
};

// All action types combined
export const ALL_ACTION_TYPES = {
  ...AUTH_ACTIONS,
  ...CAMPAIGN_ACTIONS,
  ...USER_ACTIONS,
  ...DONATION_ACTIONS,
  ...SYSTEM_ACTIONS,
  ...OUTREACH_ACTIONS,
  ...NOTIFICATION_ACTIONS,
};

// Action type categories for filtering
export const ACTION_CATEGORIES = {
  AUTHENTICATION: Object.values(AUTH_ACTIONS),
  CAMPAIGN: Object.values(CAMPAIGN_ACTIONS),
  USER_MANAGEMENT: Object.values(USER_ACTIONS),
  DONATION: Object.values(DONATION_ACTIONS),
  SYSTEM: Object.values(SYSTEM_ACTIONS),
  OUTREACH: Object.values(OUTREACH_ACTIONS),
  NOTIFICATION: Object.values(NOTIFICATION_ACTIONS),
};

// Security level classifications
export const SECURITY_LEVELS = {
  LOW: "LOW",
  MEDIUM: "MEDIUM",
  HIGH: "HIGH",
  CRITICAL: "CRITICAL",
};

// Action security mappings
export const ACTION_SECURITY_LEVELS = {
  // Critical security events
  [AUTH_ACTIONS.USER_LOGIN]: SECURITY_LEVELS.HIGH,
  [AUTH_ACTIONS.PASSWORD_CHANGED]: SECURITY_LEVELS.HIGH,
  [AUTH_ACTIONS.ACCOUNT_SUSPENDED]: SECURITY_LEVELS.CRITICAL,
  [SYSTEM_ACTIONS.SECURITY_ALERT]: SECURITY_LEVELS.CRITICAL,

  // High importance events
  [CAMPAIGN_ACTIONS.CAMPAIGN_APPROVED]: SECURITY_LEVELS.HIGH,
  [CAMPAIGN_ACTIONS.CAMPAIGN_REJECTED]: SECURITY_LEVELS.HIGH,
  [CAMPAIGN_ACTIONS.CAMPAIGN_CANCELLED]: SECURITY_LEVELS.HIGH,
  [USER_ACTIONS.USER_ROLE_CHANGED]: SECURITY_LEVELS.HIGH,
  [DONATION_ACTIONS.DONATION_MADE]: SECURITY_LEVELS.HIGH,

  // Medium importance events
  [CAMPAIGN_ACTIONS.CAMPAIGN_CREATED]: SECURITY_LEVELS.MEDIUM,
  [CAMPAIGN_ACTIONS.CAMPAIGN_UPDATED]: SECURITY_LEVELS.MEDIUM,
  [USER_ACTIONS.USER_PROFILE_UPDATED]: SECURITY_LEVELS.MEDIUM,

  // Low importance events
  [AUTH_ACTIONS.USER_LOGOUT]: SECURITY_LEVELS.LOW,
  [NOTIFICATION_ACTIONS.NOTIFICATION_READ]: SECURITY_LEVELS.LOW,
};
